
{namespace t3jquery=Tx_T3jquery_ViewHelpers}

<div id="tabs-{data.uid}" class="tabs{f:if( condition: layout, then: ' {layout}' )}">
	<ul class="nav nav-tabs">
		<f:for each="{items}" key="key" as="item">
			<li class="{f:if( condition: '{active} == {key}', then: 'active' )}">
				<a href="{f:uri.page( additionalParams: { type: 1370426637, tx_adxtwitterbootstrap: { uid: '{item.uid}' } } )}#tab-item-{item.uid}" data-toggle="tab">{item.header}</a>
			</li>
		</f:for>
	</ul>
	<div class="tab-content">
		<f:for each="{items}" key="key" as="item">
			<div id="tab-item-{item.uid}" class="tab-pane fade{f:if( condition: '{active} == {key}', then: ' active in' )}">
				<f:if condition="{ajaxLoading}">
					<f:then>
						<f:if condition="{active} == {key}">
							<f:cObject typoscriptObjectPath="tt_content" data="{item}" />
						</f:if>
					</f:then>
					<f:else>
						<f:cObject typoscriptObjectPath="tt_content" data="{item}" />
					</f:else>
				</f:if>
			</div>
		</f:for>
	</div>
</div>

<t3jquery:AddJQueryAndScript renderChildrenToData="TRUE">
	(function($){
		var $tabs = $('#tabs-{data.uid}'),
			slideToPosition = Boolean('{slideToPosition}'),
			slideOffset = Number('{slideOffset}'),
			ajaxLoading = Boolean('{ajaxLoading}');
		if (slideToPosition){
			$tabs.find('a[data-toggle="tab"]').on('shown.bs.tab', function(event){
				$('html, body').stop().animate({
					scrollTop: $(event.target).offset().top - slideOffset
				}, 'slow');
			});
		}
		if (ajaxLoading){
			$tabs.find('a[data-toggle="tab"]').on('show.bs.tab', function(event){
				var $tabItem = $(event.target),
					linkParts = $tabItem.attr('href').split('#tab-item-'),
					$tabPane = $('#tab-item-' + linkParts[1]);
				if (!$.trim($tabPane.html())){
					$tabPane.addClass('loading')
					$tabItem.addClass('loading');
					$.get(linkParts[0])
						.success(function(data){
							$tabItem.removeClass('loading');
							$tabPane
								.removeClass('loading')
								.append(data);
						});
				}
			});
		}
	})(jQuery);
</t3jquery:AddJQueryAndScript>
