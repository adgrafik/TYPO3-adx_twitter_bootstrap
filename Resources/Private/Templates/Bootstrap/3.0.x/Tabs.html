
{namespace t3jquery=Tx_T3jquery_ViewHelpers}

<div id="tabs-{data.uid}" class="{classes}">
	<ul class="{navClasses}">
		<f:for each="{data.tx_gridelements_view_children}" key="key" as="item" iteration="loop">
			<f:if condition="{dropdown} == 0">
				<f:then>
					<li class="{f:if( condition: '{active} == {loop.cycle}', then: 'active' )}">
						<a href="{f:uri.page( section: 'tab-item-{item.uid}', additionalParams: { type: 1370426637, tx_adxtwitterbootstrap: { uid: '{item.uid}' } } )}" data-toggle="tab">{item.header}</a>
					</li>
				</f:then>
				<f:else>
					<f:if condition="{dropdown} == {loop.cycle}">
						<f:then>
							<li class="dropdown{f:if( condition: '{active} >= {loop.cycle}', then: ' active' )}">
								<a id="dropdown-{item.uid}" class="dropdown-toggle" href="#" data-toggle="dropdown">{dropdownLabel} <b class="caret"></b></a>
								<ul class="dropdown-menu" role="menu" aria-labelledby="dropdown-{item.uid}">
						</f:then>
						<f:else>
							<li class="{f:if( condition: '{active} == {loop.cycle}', then: 'active' )}">
								<a href="{f:uri.page( section: 'tab-item-{item.uid}', additionalParams: { type: 1370426637, tx_adxtwitterbootstrap: { uid: '{item.uid}' } } )}" tabindex="-1" data-toggle="tab">{item.header}</a>
							</li>
						</f:else>
					</f:if>
					<f:if condition="{loop.isLast}">
							</ul>
						</li>
					</f:if>
				</f:else>
			</f:if>
		</f:for>
	</ul>
	<f:if condition="{clearAfterNav}">
		<div class="{clearAfterNav}"></div>
	</f:if>
	<div class="{paneClasses}">
		<f:for each="{data.tx_gridelements_view_children}" key="key" as="item" iteration="loop">
			<div id="tab-item-{item.uid}" class="tab-pane fade{f:if( condition: '{active} == {loop.cycle}', then: ' active in' )}">
				<f:if condition="{ajaxLoading}">
					<f:then>
						<f:if condition="{active} == {loop.cycle}">
							<f:cObject typoscriptObjectPath="tt_content" data="{item}" />
						</f:if>
					</f:then>
					<f:else>
						<f:cObject typoscriptObjectPath="tt_content" data="{item}" />
					</f:else>
				</f:if>
			</div>
		</f:for>
	</div>
</div>

<t3jquery:AddJQueryAndScript renderChildrenToData="TRUE">
	(function($){
		var $tabs = $('#tabs-{data.uid}'),
			slideToPosition = {slideToPosition},
			slideOffset = {slideOffset},
			ajaxLoading = {ajaxLoading};
		if (slideToPosition){
			$tabs.find('a[data-toggle="tab"]').on('shown.bs.tab', function(event){
				$('html, body').stop().animate({
					scrollTop: $(event.target).offset().top - slideOffset
				}, 'slow');
			});
		}
		if (ajaxLoading){
			$tabs.find('a[data-toggle="tab"]').on('show.bs.tab', function(event){
				var $tabItem = $(event.target),
					linkParts = $tabItem.attr('href').split('#tab-item-'),
					$tabPane = $('#tab-item-' + linkParts[1]);
				if (!$.trim($tabPane.html())){
					$tabPane.addClass('loading')
					$tabItem.addClass('loading');
					$.get(linkParts[0])
						.success(function(data){
							$tabItem.removeClass('loading');
							$tabPane
								.removeClass('loading')
								.append(data);
						});
				}
			});
		}
	})(jQuery);
</t3jquery:AddJQueryAndScript>
